app:
  description: æ•°æ®é—®ç­”|é€šç”¨é—®ç­”|è¡¨æ ¼é—®ç­”|æŠ¥å‘Šé—®ç­”
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: æ•°æ®é—®ç­”_v1.1.2_deepseek
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.0.4@925a003ff416de88ca7d3624b53ea1307cf1b4bf8315924d37c7eb704230ed28
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/deepseek:0.0.5@fd6efd37c2a931911de8ab9ca3ba2da303bef146d45ee87ad896b04b36d09403
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: true
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: tool
      id: 1721978213302-source-1721978268262-target
      selected: false
      source: '1721978213302'
      sourceHandle: source
      target: '1721978268262'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: code
      id: 1721978268262-source-1721978276391-target
      selected: false
      source: '1721978268262'
      sourceHandle: source
      target: '1721978276391'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: code
      id: 1721978276391-source-1721978435688-target
      selected: false
      source: '1721978276391'
      sourceHandle: source
      target: '1721978435688'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1721978435688-source-1721978465891-target
      selected: false
      source: '1721978435688'
      sourceHandle: source
      target: '1721978465891'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1721978465891-true-1721978416917-target
      selected: false
      source: '1721978465891'
      sourceHandle: 'true'
      target: '1721978416917'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1724295046398-source-1724295169935-target
      selected: false
      source: '1724295046398'
      sourceHandle: source
      target: '1724295169935'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1724295169935-source-1724295615269-target
      selected: false
      source: '1724295169935'
      sourceHandle: source
      target: '1724295615269'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1724295615269-false-1724295640306-target
      selected: false
      source: '1724295615269'
      sourceHandle: 'false'
      target: '1724295640306'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1724295615269-true-1724295728093-target
      selected: false
      source: '1724295615269'
      sourceHandle: 'true'
      target: '1724295728093'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1730887499318-source-1730887562850-target
      selected: false
      source: '1730887499318'
      sourceHandle: source
      target: '1730887562850'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1730887562850-source-1730887626621-target
      selected: false
      source: '1730887562850'
      sourceHandle: source
      target: '1730887626621'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1730887626621-true-1730887662105-target
      selected: false
      source: '1730887626621'
      sourceHandle: 'true'
      target: '1730887662105'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1732517672259-d7c25be0-954f-4965-a2f1-20d29f530704-1721978504647-target
      selected: false
      source: '1732517672259'
      sourceHandle: d7c25be0-954f-4965-a2f1-20d29f530704
      target: '1721978504647'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1732520123593-source-1732520201744-target
      selected: false
      source: '1732520123593'
      sourceHandle: source
      target: '1732520201744'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1732520201744-source-1732520268554-target
      selected: false
      source: '1732520201744'
      sourceHandle: source
      target: '1732520268554'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: http-request
      id: 1732517672259-c1319e61-38af-4482-979b-3a2e2c4e6026-1730887499318-target
      selected: false
      source: '1732517672259'
      sourceHandle: c1319e61-38af-4482-979b-3a2e2c4e6026
      target: '1730887499318'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: if-else
      id: 1721978465891-false-1732517672259-target
      selected: false
      source: '1721978465891'
      sourceHandle: 'false'
      target: '1732517672259'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: code
      id: 1732517672259-68588ce1-7f5d-4af9-8191-4320e927e7fd-1734683532736-target
      selected: false
      source: '1732517672259'
      sourceHandle: 68588ce1-7f5d-4af9-8191-4320e927e7fd
      target: '1734683532736'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1734683532736-source-1734683610947-target
      selected: false
      source: '1734683532736'
      sourceHandle: source
      target: '1734683610947'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: http-request
      id: 1734683610947-true-1732520123593-target
      selected: false
      source: '1734683610947'
      sourceHandle: 'true'
      target: '1732520123593'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: http-request
      id: 1734683610947-false-17355251156380-target
      selected: false
      source: '1734683610947'
      sourceHandle: 'false'
      target: '17355251156380'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 17355251156380-source-1735525806917-target
      selected: false
      source: '17355251156380'
      sourceHandle: source
      target: '1735525806917'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1735525806917-source-1735526005555-target
      selected: false
      source: '1735525806917'
      sourceHandle: source
      target: '1735526005555'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: http-request
      id: 1735526005555-source-17355298585890-target
      selected: false
      source: '1735526005555'
      sourceHandle: source
      target: '17355298585890'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 17355298585890-source-1735530100215-target
      selected: false
      source: '17355298585890'
      sourceHandle: source
      target: '1735530100215'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1735530100215-source-1735530110523-target
      selected: false
      source: '1735530100215'
      sourceHandle: source
      target: '1735530110523'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1735530110523-true-1735530121003-target
      selected: false
      source: '1735530110523'
      sourceHandle: 'true'
      target: '1735530121003'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1735530110523-false-17355423844960-target
      selected: false
      source: '1735530110523'
      sourceHandle: 'false'
      target: '17355423844960'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: http-request
      id: 1721978504647-source-1724295046398-target
      selected: false
      source: '1721978504647'
      sourceHandle: source
      target: '1724295046398'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1732517672259-true-1740559499175-target
      selected: false
      source: '1732517672259'
      sourceHandle: 'true'
      target: '1740559499175'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1740559499175-source-1740381923341-target
      source: '1740559499175'
      sourceHandle: source
      target: '1740381923341'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1724295728093-source-1724296111387-target
      source: '1724295728093'
      sourceHandle: source
      target: '1724296111387'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1732520268554-source-1732520428762-target
      source: '1732520268554'
      sourceHandle: source
      target: '1732520428762'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 17355423844960-source-1735530155560-target
      source: '17355423844960'
      sourceHandle: source
      target: '1735530155560'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: qa_type
          max_length: 100
          options: []
          required: true
          type: text-input
          variable: qa_type
      height: 90
      id: '1721978213302'
      position:
        x: 30
        y: 271.5
      positionAbsolute:
        x: 30
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: time
        provider_name: time
        provider_type: builtin
        selected: false
        title: è·å–å½“å‰æ—¶é—´
        tool_configurations:
          format: '%Y-%m-%d %H:%M:%S'
          timezone: Asia/Shanghai
        tool_label: è·å–å½“å‰æ—¶é—´
        tool_name: current_time
        tool_parameters: {}
        type: tool
      height: 116
      id: '1721978268262'
      position:
        x: 334
        y: 271.5
      positionAbsolute:
        x: 334
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(question:str) -> dict:\n    return {\n        \"dify_0_t02\"\
          : \"dify_0_t02\",\n        \"dify_1_t02\": \"dify_1_t02\",\n        \"dify_0_t04\"\
          : \"dify_0_t04\",\n        \"dify_1_t04\": \"dify_1_t04\",\n        \"dify_0_t07\"\
          : \"dify_0_t07\",\n        \"dify_1_t07\": \"dify_1_t07\",\n        \"top_k\"\
          : 50,\n        \"query_database\":\"chat_db\",\n        \"nl2sql_table_info\"\
          : \"\"\" [('view_alarm_detail(æ¡ˆå‘åœ°ç‚¹,æ‰€å±åˆ†å±€,æ¥ç”µç±»åˆ«,æŠ¥è­¦äººå§“å,æ€§åˆ«,å¹´é¾„,æ–‡åŒ–ç¨‹åº¦,å—å®³äººèŒä¸š,æ‰‹æœºå“ç‰Œ,æ¶‰æ¡ˆèµ„é‡‘,æ˜¯å¦ç”µè¯ˆ,è¯ˆéª—ç±»å‹,å¼•æµæ–¹å¼,å¼•æµåœ°å€,å¼•æµè”ç³»æ—¶é—´,æ˜¯å¦çœ‹è¿‡åè¯ˆå®£ä¼ ,ç™»è®°æ—¶é—´)')]\"\
          \"\",\n        \"nl2sql_display_type\": \"\"\"\n            response_line_chart:used\
          \ to display comparative trend analysis data.\n            response_pie_chart:suitable\
          \ for scenarios such as proportion and distribution statistics.\n      \
          \      response_table:suitable for display with many display columns or\
          \ non-numeric columns.\n            response_bar_chart: displays comparative\
          \ data, volumes across varied groups. Ideal for discrete values, lengths\
          \ signify item magnitude. Each bar, a category, aids quick comparison.\"\
          \"\",\n        \"nl2sql_response\": \"\"\"{\"thoughts\":\"thoughts summary\
          \ to say to user\",\"sql\":\"SQL Query to run\",\"type\":\"Data display\
          \ method\",\"status\":\"0\"}\"\"\",\n        \"data_reveal\":\"æ ¹æ®æ‚¨çš„é—®é¢˜ï¼Œæ•°æ®é—®ç­”å°åŠ©æ‰‹æ²¡æœ‰æŸ¥è¯¢åˆ°ç›¸å…³ç»“æœï¼Œè¯·æ¢ä¸ªé—®é¢˜è¯•è¯•\"\
          ,\n        \"who_are_you\":'æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ•°æ®é—®ç­”å°åŠ©æ‰‹ã€‚ä½ å¯ä»¥å‘æˆ‘æé—®ï¼Œæˆ‘ä¼šæ ¹æ®ä½ çš„é—®é¢˜å›ç­”ï¼Œå¿«æ¥è¯•è¯•å§ã€‚'\n  \
          \  }"
        code_language: python3
        desc: ''
        outputs:
          data_reveal:
            children: null
            type: string
          dify_0_t02:
            children: null
            type: string
          dify_0_t04:
            children: null
            type: string
          dify_0_t07:
            children: null
            type: string
          dify_1_t02:
            children: null
            type: string
          dify_1_t04:
            children: null
            type: string
          dify_1_t07:
            children: null
            type: string
          nl2sql_display_type:
            children: null
            type: string
          nl2sql_response:
            children: null
            type: string
          nl2sql_table_info:
            children: null
            type: string
          query_database:
            children: null
            type: string
          top_k:
            children: null
            type: number
          who_are_you:
            children: null
            type: string
        selected: false
        title: å®šä¹‰å…¨å±€å˜é‡
        type: code
        variables:
        - value_selector:
          - sys
          - query
          variable: question
      height: 54
      id: '1721978276391'
      position:
        x: 638
        y: 271.5
      positionAbsolute:
        x: 638
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1721978276391.who_are_you#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 143
      id: '1721978416917'
      position:
        x: 1550
        y: 271.5
      positionAbsolute:
        x: 1550
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(query) -> dict:\n\n    question_pool = ['ä½ æ˜¯è°ï¼Ÿ','ä½ æ˜¯è°å•Šï¼Ÿ','ä½ çš„èº«ä»½æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆæ¨¡å‹ï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆæ¨¡å‹å•Šï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆå¤§æ¨¡å‹ï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆå¤§æ¨¡å‹å•Šï¼Ÿ','ä½ ç”¨çš„ä»€ä¹ˆå¤§æ¨¡å‹ï¼Ÿ','ä½ ç”¨çš„ä»€ä¹ˆå¤§æ¨¡å‹å•Šï¼Ÿ','ä½ æ˜¯å“ªä¸ªæ¨¡å‹ï¼Ÿ','ä½ æ˜¯å“ªä¸ªæ¨¡å‹å•Šï¼Ÿ','ä½ ç”¨çš„å“ªä¸ªæ¨¡å‹ï¼Ÿ','ä½ ç”¨çš„å“ªä¸ªæ¨¡å‹å•Šï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆç±»å‹çš„AIï¼Ÿ','ä½ æ˜¯åŸºäºä»€ä¹ˆæŠ€æœ¯çš„ï¼Ÿ','ä½ ç”¨çš„ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ','ä½ æ˜¯å“ªä¸ªAIï¼Ÿ','ä½ æ˜¯ä»€ä¹ˆAIç³»ç»Ÿï¼Ÿ','ä½ æ˜¯ç”¨ä»€ä¹ˆæŠ€æœ¯å¼€å‘çš„ï¼Ÿ','ä½ æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ','ä½ çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ æ˜¯ç”¨ä»€ä¹ˆæ¨¡å‹è®­ç»ƒçš„ï¼Ÿ','ä½ èƒŒåæ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ','ä½ æ˜¯å“ªç§AIï¼Ÿ','ä½ æ˜¯å“ªä¸ªå…¬å¸çš„AIï¼Ÿ','ä½ çš„å¼€å‘å…¬å¸æ˜¯è°ï¼Ÿ','ä½ æ˜¯ç”±è°è®¾è®¡çš„ï¼Ÿ','ä½ çš„è®¾è®¡è€…æ˜¯è°ï¼Ÿ','ä½ çš„å¼€å‘è€…æ˜¯è°ï¼Ÿ','ä½ å±äºå“ªä¸ªå›¢é˜Ÿï¼Ÿ','ä½ çš„æŠ€æœ¯åŸºç¡€æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ æ˜¯å“ªä¸€ç±»AIï¼Ÿ','ä½ æ˜¯ç”±ä»€ä¹ˆç®—æ³•æ”¯æŒçš„ï¼Ÿ','ä½ æ˜¯å“ªä¸ªç‰ˆæœ¬çš„AIï¼Ÿ','ä½ çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘ï¼Ÿ','ä½ æ˜¯åŸºäºå“ªä¸ªå¹³å°çš„ï¼Ÿ','ä½ æ˜¯åŸºäºä»€ä¹ˆå¹³å°ï¼Ÿ','ä½ ç”±è°åˆ¶é€ ï¼Ÿ','ä½ çš„åˆ¶é€ å•†æ˜¯è°ï¼Ÿ','ä½ æ˜¯å“ªä¸ªæ¶æ„ï¼Ÿ','ä½ çš„æ¶æ„æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ æ˜¯å“ªå®¶å…¬å¸å¼€å‘çš„ï¼Ÿ','ä½ ç”±ä»€ä¹ˆæŠ€æœ¯æ”¯æ’‘ï¼Ÿ','ä½ ç”±ä»€ä¹ˆé©±åŠ¨ï¼Ÿ','ä½ çš„å·¥ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ ä½¿ç”¨äº†å“ªäº›æŠ€æœ¯ï¼Ÿ','ä½ æ˜¯å¦‚ä½•è¢«è®­ç»ƒçš„ï¼Ÿ','ä½ ç”¨ä»€ä¹ˆæ•°æ®è®­ç»ƒçš„ï¼Ÿ','ä½ çš„è®­ç»ƒæ•°æ®æ˜¯ä»€ä¹ˆï¼Ÿ','ä½ æ˜¯è°','ä½ æ˜¯è°å•Š','ä½ çš„èº«ä»½æ˜¯ä»€ä¹ˆ','ä½ æ˜¯ä»€ä¹ˆæ¨¡å‹','ä½ æ˜¯ä»€ä¹ˆæ¨¡å‹å•Š','ä½ æ˜¯ä»€ä¹ˆå¤§æ¨¡å‹','ä½ æ˜¯ä»€ä¹ˆå¤§æ¨¡å‹å•Š','ä½ ç”¨çš„ä»€ä¹ˆå¤§æ¨¡å‹','ä½ ç”¨çš„ä»€ä¹ˆå¤§æ¨¡å‹å•Š','ä½ æ˜¯å“ªä¸ªæ¨¡å‹','ä½ æ˜¯å“ªä¸ªæ¨¡å‹å•Š','ä½ ç”¨çš„å“ªä¸ªæ¨¡å‹','ä½ ç”¨çš„å“ªä¸ªæ¨¡å‹å•Š','ä½ æ˜¯ä»€ä¹ˆç±»å‹çš„AI','ä½ æ˜¯åŸºäºä»€ä¹ˆæŠ€æœ¯çš„','ä½ ç”¨çš„ä»€ä¹ˆæŠ€æœ¯','ä½ æ˜¯å“ªä¸ªAI','ä½ æ˜¯ä»€ä¹ˆAIç³»ç»Ÿ','ä½ æ˜¯ç”¨ä»€ä¹ˆæŠ€æœ¯å¼€å‘çš„','ä½ æ˜¯æ€ä¹ˆå·¥ä½œçš„','ä½ çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ','ä½ æ˜¯ç”¨ä»€ä¹ˆæ¨¡å‹è®­ç»ƒçš„','ä½ èƒŒåæ˜¯ä»€ä¹ˆç®—æ³•','ä½ æ˜¯å“ªç§AI','ä½ æ˜¯å“ªä¸ªå…¬å¸çš„AI','ä½ çš„å¼€å‘å…¬å¸æ˜¯è°','ä½ æ˜¯ç”±è°è®¾è®¡çš„','ä½ çš„è®¾è®¡è€…æ˜¯è°','ä½ çš„å¼€å‘è€…æ˜¯è°','ä½ å±äºå“ªä¸ªå›¢é˜Ÿ','ä½ çš„æŠ€æœ¯åŸºç¡€æ˜¯ä»€ä¹ˆ','ä½ çš„ç®—æ³•æ˜¯ä»€ä¹ˆ','ä½ æ˜¯å“ªä¸€ç±»AI','ä½ æ˜¯ç”±ä»€ä¹ˆç®—æ³•æ”¯æŒçš„','ä½ æ˜¯å“ªä¸ªç‰ˆæœ¬çš„AI','ä½ çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘','ä½ æ˜¯åŸºäºå“ªä¸ªå¹³å°çš„','ä½ æ˜¯åŸºäºä»€ä¹ˆå¹³å°','ä½ ç”±è°åˆ¶é€ ','ä½ çš„åˆ¶é€ å•†æ˜¯è°','ä½ æ˜¯å“ªä¸ªæ¶æ„','ä½ çš„æ¶æ„æ˜¯ä»€ä¹ˆ','ä½ æ˜¯å“ªå®¶å…¬å¸å¼€å‘çš„','ä½ ç”±ä»€ä¹ˆæŠ€æœ¯æ”¯æ’‘','ä½ ç”±ä»€ä¹ˆé©±åŠ¨','ä½ çš„å·¥ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆ','ä½ ä½¿ç”¨äº†å“ªäº›æŠ€æœ¯','ä½ æ˜¯å¦‚ä½•è¢«è®­ç»ƒçš„','ä½ ç”¨ä»€ä¹ˆæ•°æ®è®­ç»ƒçš„','ä½ çš„è®­ç»ƒæ•°æ®æ˜¯ä»€ä¹ˆ',\
          \ \"ä½ å¥½å•Š\", \"ä½ å¥½\", \"æ‚¨å¥½å•Š\", \"æ‚¨å¥½\"]\n    for keywords in question_pool:\n\
          \        if keywords in query:\n            return {\"result\": 1}\n   \
          \ else:\n        return {\"result\": 2}"
        code_language: python3
        desc: èº«ä»½åˆ¤æ–­
        outputs:
          result:
            children: null
            type: number
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - sys
          - query
          variable: query
      height: 82
      id: '1721978435688'
      position:
        x: 942
        y: 271.5
      positionAbsolute:
        x: 942
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: 924a6c79-d3b4-4918-8dc6-9af27df89692
            numberVarType: constant
            value: '1'
            varType: number
            variable_selector:
            - '1721978435688'
            - result
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ¡ä»¶åˆ†æ”¯
        type: if-else
      height: 126
      id: '1721978465891'
      position:
        x: 1246
        y: 271.5
      positionAbsolute:
        x: 1246
        y: 271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”ŸæˆSQLè¯­å¥
        model:
          completion_params:
            num_thread: 4
            temperature: 0.5
          mode: chat
          name: qwen2.5-72b-instruct
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 857c0bfd-73a8-47b2-b6fe-b7e738894b8d
          role: system
          text: '# ä½ æ˜¯ä¸€ä¸ªDBAï¼Œæ“…é•¿ç¼–å†™å¤æ‚ä¸”æ ‡å‡†çš„SQLè¯­å¥


            # ä½ çš„ä»»åŠ¡æ˜¯ï¼š

            æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„MYSQLæ•°æ®åº“å’Œæä¾›çš„è¡¨ç»“æ„å®šä¹‰ï¼Œå›ç­”ç”¨æˆ·é—®é¢˜å¹¶ç”Ÿæˆæ­£ç¡®çš„SQLæŸ¥è¯¢ã€‚


            # è¡¨ç»“æ„å®šä¹‰ï¼š{{#1721978276391.nl2sql_table_info#}}'
        - id: 0305276b-e6f7-4897-a90d-c39dcaf8c02b
          role: user
          text: 'human: {{#sys.query#}}æŸ¥è¯¢


            # çº¦æŸ:

            - è¯·æ ¹æ®ç”¨æˆ·é—®é¢˜ç†è§£ç”¨æˆ·æ„å›¾ï¼Œä½¿ç”¨ç»™å‡ºè¡¨ç»“æ„å®šä¹‰åˆ›å»ºä¸€ä¸ªè¯­æ³•æ­£ç¡®çš„ mysql sqlï¼Œå¦‚æœä¸éœ€è¦sqlï¼Œåˆ™ç›´æ¥å›ç­”ç”¨æˆ·é—®é¢˜ã€‚Â 


            - åªèƒ½ä½¿ç”¨è¡¨ç»“æ„ä¿¡æ¯ä¸­æä¾›çš„è¡¨æ¥ç”Ÿæˆ sqlï¼Œå¦‚æœæ— æ³•æ ¹æ®æä¾›çš„è¡¨ç»“æ„ä¸­ç”Ÿæˆ sql ï¼Œè¯·è¯´ï¼š''æä¾›çš„è¡¨ç»“æ„ä¿¡æ¯ä¸è¶³ä»¥ç”Ÿæˆ sql æŸ¥è¯¢ã€‚''ç¦æ­¢éšæ„æé€ ä¿¡æ¯ã€‚Â 


            - è¯·æ³¨æ„ç”ŸæˆSQLæ—¶ä¸è¦å¼„é”™è¡¨å’Œåˆ—çš„å…³ç³»Â 


            - è¯·æ£€æŸ¥SQLçš„æ­£ç¡®æ€§ï¼Œå¹¶ä¿è¯æ­£ç¡®çš„æƒ…å†µä¸‹ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½Â 


            - æ‰€æœ‰æŸ¥è¯¢çš„å€¼éƒ½å¿…é¡»æœ‰åˆ«åï¼Œæ¯”å¦‚ä»è¡¨ä¸­é€‰æ‹© select æ‰€å±åˆ†å±€, COUNT(*)as æ€»æ•°,SUM(æ¶‰æ¡ˆèµ„é‡‘) as æ¶‰æ¡ˆèµ„é‡‘ from
            view_alarm_detail group by æ‰€å±åˆ†å±€


            - thoughtså°½é‡ç”¨ä¸­æ–‡å›ç­”ä¸è¦è¾“å‡º`å­—ç¬¦


            - ç”¨æˆ·åœ¨é—®é¢˜ä¸­æŒ‡å®šäº†ä»–å¸Œæœ›è·å¾—çš„å…·ä½“æ•°æ®è¡Œæ•°ï¼Œå¦‚æœå¤§äº50åˆ™å§‹ç»ˆå°†æŸ¥è¯¢é™åˆ¶ä¸ºæœ€å¤šÂ 

            {{#1721978276391.top_k#}}ä¸ªç»“æœã€‚


            - å½“é—®é¢˜ä¸­å‡ºç°åƒæ—¶é—´ï¼Œæ—¥æœŸï¼Œæœˆä»½ï¼Œå¹´ï¼Œå°æ—¶ï¼Œå­£åº¦ï¼Œå¤©ç­‰è¡¨ç¤ºæ—¶é—´çš„å…³é”®å­—ï¼Œå¿…é¡»ä½¿ç”¨view_alarm_detailè¡¨çš„''ç™»è®°æ—¥æœŸ''å­—æ®µè¿›è¡ŒæŸ¥è¯¢ç»Ÿè®¡


            - å½“é—®é¢˜ä¸­å‡ºç°åƒç”µè¯æŠ¥è­¦ï¼Œè‡ªæŠ¥è­¦çš„å…³é”®å­—å¿…é¡»ä½¿ç”¨view_alarm_detailè¡¨çš„æ¥ç”µç±»åˆ«å­—æ®µè¿›è¡ŒæŸ¥è¯¢ç»Ÿè®¡


            - å½“ä½¿ç”¨view_alarm_detailè¡¨çš„æ¡ˆå‘åœ°ç‚¹,ç®¡è¾–å•ä½,è”ç³»åœ°å€,æ‰€åœ¨å•ä½,è¯ˆéª—ç±»å‹å­—æ®µå¿…é¡»ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢ç»Ÿè®¡


            - å½“å‰æ—¥æœŸ,ä»Šå¹´ä½¿ç”¨Â {{#1721978268262.text#}}


            -  è¯·ä»å¦‚ä¸‹ç»™å‡ºçš„å±•ç¤ºæ–¹å¼ç§é€‰æ‹©æœ€å½¢è±¡çš„ä¸€ç§ç”¨ä»¥è¿›è¡Œæ•°æ®æ¸²æŸ“ï¼Œå°†ç±»å‹åç§°æ”¾å…¥è¿”å›è¦æ±‚æ ¼å¼çš„nameå‚æ•°å€¼ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æœ€åˆé€‚çš„åˆ™ä½¿ç”¨Tableä½œä¸ºå±•ç¤ºæ–¹å¼ï¼Œæ•°æ®å±•ç¤ºæ–¹å¼å¦‚ä¸‹:Â 
            {{#1721978276391.nl2sql_display_type#}}


            # è¿”å›æ ¼å¼Â 

            è¯·ä¸€æ­¥æ­¥æ€è€ƒå¹¶æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼å›å¤ï¼šÂ {{#1721978276391.nl2sql_response#}}

            ç¡®ä¿è¿”å›æ­£ç¡®çš„jsonå¹¶ä¸”å¯ä»¥è¢«Python json.loadsæ–¹æ³•è§£æ.'
        selected: false
        title: æ•°æ®åº“é—®ç­”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '1721978504647'
      position:
        x: 1854
        y: 518
      positionAbsolute:
        x: 1854
        y: 518
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-115
            key: llm_text
            type: text
            value: '{{#1721978504647.text#}}'
          type: x-www-form-urlencoded
        desc: æ‰§è¡ŒSQLè¯­å¥å°è£…ç»“æœé›†
        headers: ''
        method: post
        params: question:{{#sys.query#}}
        retry_config:
          max_retries: 1
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: è·å–æ•°æ®åº“ç»“æœ
        type: http-request
        url: http://host.docker.internal:8088/llm/process_llm_out
        variables: []
      height: 164
      id: '1724295046398'
      position:
        x: 2158
        y: 518
      positionAbsolute:
        x: 2158
        y: 518
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main( db_result: str):\n    try:\n        db_result_json\
          \ = json.loads(db_result)\n        \n        db_data = json.loads(db_result_json['data'])\n\
          \n        return {\n            \"res_code\": str(db_result_json['code']),\n\
          \            \"res_data\": str(db_data['data'])\n        }\n    except Exception\
          \ as e :\n        return {\"res_code\": \"9999\",\"outline\": f\"{e}\"}"
        code_language: python3
        dependencies:
        - name: ''
          version: ''
        desc: ''
        outputs:
          res_code:
            children: null
            type: string
          res_data:
            children: null
            type: string
        selected: false
        title: è§£æè¿”å›ç»“æœ
        type: code
        variables:
        - value_selector:
          - '1724295046398'
          - body
          variable: db_result
      height: 54
      id: '1724295169935'
      position:
        x: 2462
        y: 518
      positionAbsolute:
        x: 2462
        y: 518
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: ebd67bc7-0abf-40b5-b8f0-a253a87d704d
            value: '200'
            varType: string
            variable_selector:
            - '1724295169935'
            - res_code
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­çŠ¶æ€
        type: if-else
      height: 126
      id: '1724295615269'
      position:
        x: 2766
        y: 518
      positionAbsolute:
        x: 2766
        y: 518
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1721978276391.data_reveal#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: è¿”å›å¤±è´¥
        type: answer
        variables: []
      height: 143
      id: '1724295640306'
      position:
        x: 3070
        y: 518
      positionAbsolute:
        x: 3070
        y: 518
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”Ÿæˆæ€»ç»“ä¿¡æ¯
        model:
          completion_params:
            num_ctx: 20480
            num_thread: 4
            temperature: 0.7
          mode: chat
          name: deepseek-reasoner
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 48d8610a-aab1-4e2e-8fd1-3111b94de508
          role: system
          text: '# ä»è¯ˆéª—æ•°æ®ä¸­æ€»ç»“åˆ†æå‡ºæ•°æ®è¶‹åŠ¿

            '
        - id: d424dafa-ebed-4271-90e5-4bafff0ca243
          role: user
          text: "# ä»»åŠ¡: ä»è¯ˆéª—æ•°æ®ä¸­æ€»ç»“åˆ†æå‡ºæ•°æ®è¶‹åŠ¿\n\n----\n# è¯ˆéª—æ•°æ®:  {{#1724295169935.res_data#}}\n\
            ----\n# çº¦æŸ:\n - è¾“å‡ºç»“æœä¸èƒ½å‡ºç°è‹±æ–‡å’Œç¹ä½“å­—\n - ä¸¥æ ¼ä¾æ®æ•°æ®é›†å›ç­”ä¸è¦è™šæ„\n - ä¸è¦è¾“å‡º ```markdown\n\
            \n# è¾“å‡ºæ ¼å¼: markdownæ ¼å¼è¾“å‡º"
        selected: false
        title: åˆ†ææ€»ç»“ç»“æœ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '1724295728093'
      position:
        x: 3070
        y: 701
      positionAbsolute:
        x: 3070
        y: 701
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1724295728093.text#}}{{#1721978276391.dify_1_t02#}}

          {{#1721978276391.dify_0_t04#}}{{#1724295046398.body#}}{{#1721978276391.dify_1_t04#}}'
        desc: ''
        selected: false
        title: å“åº”ç»“æœé›†
        type: answer
        variables: []
      height: 200
      id: '1724296111387'
      position:
        x: 3374
        y: 688.5
      positionAbsolute:
        x: 3374
        y: 688.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - type: text
            value: ''
          type: none
        desc: ''
        headers: ''
        method: get
        params: query_str:{{#sys.query#}}
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: æŠ¥å‘Šé—®ç­”
        type: http-request
        url: http://host.docker.internal:8088/llm/query_guided_report
        variables: []
      height: 136
      id: '1730887499318'
      position:
        x: 1854
        y: 721
      positionAbsolute:
        x: 1854
        y: 721
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\n\ndef main(query_result: str):\n    try:\n        parsed_json\
          \ = json.loads(query_result)\n        if not isinstance(parsed_json, dict):\n\
          \            parsed_json = json.loads(parsed_json)\n\n        return {\n\
          \            \"res_code\": str(parsed_json['code']),\n            \"mark_down\"\
          : parsed_json['data']\n        }\n    except Exception as e :\n        return\
          \ {\"res_code\": \"9999\",\"outline\": f\"{e}\"}"
        code_language: python3
        desc: ''
        outputs:
          mark_down:
            children: null
            type: string
          res_code:
            children: null
            type: string
        selected: false
        title: è§£æè¿”å›ç»“æœ
        type: code
        variables:
        - value_selector:
          - '1730887499318'
          - body
          variable: query_result
      height: 54
      id: '1730887562850'
      position:
        x: 2158
        y: 784
      positionAbsolute:
        x: 2158
        y: 784
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 066e4a01-43dc-4ce2-be97-243fb65e7208
            value: '200'
            varType: string
            variable_selector:
            - '1730887562850'
            - res_code
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­çŠ¶æ€
        type: if-else
      height: 126
      id: '1730887626621'
      position:
        x: 2462
        y: 693.5
      positionAbsolute:
        x: 2462
        y: 693.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1730887562850.mark_down#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: è¿”å›ç»“æœ
        type: answer
        variables: []
      height: 143
      id: '1730887662105'
      position:
        x: 2766
        y: 721
      positionAbsolute:
        x: 2766
        y: 721
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 3bcc3968-d3ab-4c01-9149-40cb943e491f
            value: COMMON_QA
            varType: string
            variable_selector:
            - '1721978213302'
            - qa_type
          id: 'true'
          logical_operator: and
        - case_id: d7c25be0-954f-4965-a2f1-20d29f530704
          conditions:
          - comparison_operator: contains
            id: 6a4c44d6-d442-4628-8faf-42c7d10c5711
            value: DATABASE_QA
            varType: string
            variable_selector:
            - '1721978213302'
            - qa_type
          id: d7c25be0-954f-4965-a2f1-20d29f530704
          logical_operator: and
        - case_id: 68588ce1-7f5d-4af9-8191-4320e927e7fd
          conditions:
          - comparison_operator: contains
            id: be63fafa-e43f-4448-bcce-227ddda1f6d7
            value: FILEDATA_QA
            varType: string
            variable_selector:
            - '1721978213302'
            - qa_type
          id: 68588ce1-7f5d-4af9-8191-4320e927e7fd
          logical_operator: and
        - case_id: c1319e61-38af-4482-979b-3a2e2c4e6026
          conditions:
          - comparison_operator: contains
            id: 3d96735d-1e97-43e3-95b1-3bcf398889db
            value: REPORT_QA
            varType: string
            variable_selector:
            - '1721978213302'
            - qa_type
          id: c1319e61-38af-4482-979b-3a2e2c4e6026
          logical_operator: and
        desc: ''
        selected: false
        title: æ„å›¾åˆ†ç±»
        type: if-else
      height: 270
      id: '1732517672259'
      position:
        x: 1550
        y: 454.5
      positionAbsolute:
        x: 1550
        y: 454.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data: []
          type: none
        desc: ''
        headers: ''
        method: post
        params: file_qa_str:{{#sys.query#}}
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: è¡¨æ ¼æ€»ç»“
        type: http-request
        url: http://host.docker.internal:8088/file/read_file
        variables: []
      height: 136
      id: '1732520123593'
      position:
        x: 2462
        y: 859.5
      positionAbsolute:
        x: 2462
        y: 859.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(file_datas: str):\n    try:\n        file_data_json\
          \ = json.loads(file_datas)\n        db_data = json.loads(file_data_json['data'])\n\
          \        return {\n            \"file_res_code\": str(file_data_json['code']),\n\
          \            \"file_res_data\": str(db_data)\n        }\n    except Exception\
          \ as e :\n        return {\"file_res_code\": \"9999\",\"file_res_data\"\
          :f\"{e}\"}"
        code_language: python3
        desc: ''
        outputs:
          file_res_code:
            children: null
            type: string
          file_res_data:
            children: null
            type: string
        selected: false
        title: è·å–æ–‡ä»¶å†…å®¹
        type: code
        variables:
        - value_selector:
          - '1732520123593'
          - body
          variable: file_datas
      height: 54
      id: '1732520201744'
      position:
        x: 2766
        y: 936
      positionAbsolute:
        x: 2766
        y: 936
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: d8002acb-7dd8-4675-8db6-df76a44094de
          role: system
          text: '# ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æä¸“å®¶


            #ä½ çš„ä»»åŠ¡æ˜¯:

            ä¸‹é¢æ˜¯ç”¨æˆ·Excel''æ–‡ä»¶éƒ¨åˆ†æ•°æ®''ï¼Œè¯·å­¦ä¹ ç†è§£è¯¥æ•°æ®çš„ç»“æ„å’Œå†…å®¹ï¼Œç®€å•æ€»ç»“æ–‡ä»¶å†…å®¹å¹¶é’ˆå¯¹æ•°æ®ä»ä¸åŒç»´åº¦æä¾›ä¸€äº›æœ‰ç”¨çš„åˆ†ææ€è·¯ç»™ç”¨æˆ·


            # æ–‡ä»¶éƒ¨åˆ†æ•°æ®:

            ---

            : {{#1732520201744.file_res_data#}}

            ---'
        - id: 0eeaab3f-73da-4dac-beb0-b7b5f225bd75
          role: user
          text: "# human:  {{#sys.query#}}\n\n# çº¦æŸ:Â \n- è¾“å‡ºå­—æ•°åœ¨200å­—ä»¥å†…\n- ä¸¥æ ¼å‚è€ƒæ–‡ä»¶æ•°æ®ä¸è¦è™šæ„ä¿¡æ¯\n\
            - å¤šä¸ªsheetéœ€è¦åˆ†å¼€åˆ†æå¹¶è¿›è¡Œå•ç‹¬è¿”å›\nè¯·ä¸€æ­¥ä¸€æ­¥æ€è€ƒ\n\n# è¾“å‡ºæ ¼å¼: \n- markdowæ–‡æœ¬å½¢å¼è¾“å‡º"
        selected: false
        title: æ€»ç»“æ–‡ä»¶å†…å®¹
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1732520268554'
      position:
        x: 3070
        y: 926.5
      positionAbsolute:
        x: 3070
        y: 926.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1732520268554.text#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: æ–‡ä»¶å†…å®¹æ€»ç»“
        type: answer
        variables: []
      height: 143
      id: '1732520428762'
      position:
        x: 3374
        y: 928.5
      positionAbsolute:
        x: 3374
        y: 928.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(query_str: str) -> dict:\n    # ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦åˆ†å‰²å­—ç¬¦ä¸²ï¼Œé»˜è®¤åˆ†éš”ç¬¦ä¸º'|'\n\
          \    parts = query_str.split('|')\n    \n    # æ£€æŸ¥åˆ†éš”åçš„åˆ—è¡¨é•¿åº¦æ˜¯å¦å¤§äº1ï¼Œä»¥ç¡®ä¿å­˜åœ¨ç¬¬äºŒä¸ªéƒ¨åˆ†\n\
          \    if len(parts) > 1:\n        # æ£€æŸ¥ç¬¬äºŒä¸ªéƒ¨åˆ†æ˜¯å¦ç­‰äºç‰¹å®šå­—ç¬¦ä¸²\n        if parts[1].strip()\
          \ == 'æ€»ç»“å½’çº³æ–‡æ¡£çš„å…³é”®ä¿¡æ¯':\n            flag=1\n        else:\n            flag=2\n\
          \    else:\n        # å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„éƒ¨åˆ†ï¼Œåˆ™è¿”å›2\n        flag=2\n    return {\n   \
          \     \"flag\": flag,\n        \"file_key\": parts[0],\n        \"question_str\"\
          : parts[1]\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          file_key:
            children: null
            type: string
          flag:
            children: null
            type: number
          question_str:
            children: null
            type: string
        selected: false
        title: åˆ†éš”æ–‡ä»¶å¯¹è¯é—®é¢˜
        type: code
        variables:
        - value_selector:
          - sys
          - query
          variable: query_str
      height: 54
      id: '1734683532736'
      position:
        x: 1854
        y: 932
      positionAbsolute:
        x: 1854
        y: 932
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: fd0fa633-bb56-4c11-b08f-7bde5b9ecd50
            value: '1'
            varType: number
            variable_selector:
            - '1734683532736'
            - flag
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ–‡ä»¶é—®ç­”æ„å›¾åˆ†ç±»
        type: if-else
      height: 126
      id: '1734683610947'
      position:
        x: 2158
        y: 918.5
      positionAbsolute:
        x: 2158
        y: 918.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data: []
          type: none
        desc: ''
        headers: ''
        method: post
        params: file_qa_str:{{#sys.query#}}
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: è¯»å–è¡¨æ ¼åˆ—
        type: http-request
        url: http://host.docker.internal:8088/file/read_file_column
        variables: []
      height: 136
      id: '17355251156380'
      position:
        x: 2462
        y: 1048
      positionAbsolute:
        x: 2462
        y: 1048
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(res_datas: str):\n    try:\n        column_data_json\
          \ = json.loads(res_datas)\n        column_data = json.loads(column_data_json['data'])\n\
          \        return {\n            \"res_code\": str(column_data_json['code']),\n\
          \            \"column_data\": 'excel_table:'+str(column_data)\n        }\n\
          \    except Exception as e :\n        return {\"res_code\": \"9999\",\"\
          res_data\":f\"{e}\"}"
        code_language: python3
        desc: ''
        outputs:
          column_data:
            children: null
            type: string
          res_code:
            children: null
            type: string
        selected: false
        title: è·å–æ–‡ä»¶åˆ—å
        type: code
        variables:
        - value_selector:
          - '17355251156380'
          - body
          variable: res_datas
      height: 54
      id: '1735525806917'
      position:
        x: 2766
        y: 1124.5
      positionAbsolute:
        x: 2766
        y: 1124.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.5
          mode: chat
          name: qwen2.5-72b-instruct
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: ea976c24-3e29-4aeb-9c63-195bf30d4790
          role: system
          text: '# ä½ æ˜¯ä¸€ä¸ªDBAæ“…é•¿ç¼–å†™å¤æ‚çš„ duckdb SQLè¯­å¥


            # ä½ çš„ä»»åŠ¡æ˜¯: è¯·æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æ•°æ®åº“å’Œè¯¥åº“çš„éƒ¨åˆ†å¯ç”¨è¡¨ç»“æ„å®šä¹‰åœ¨æ»¡è¶³ä¸‹é¢çº¦æŸæ¡ä»¶ä¸‹é€šè¿‡duckdb sqlæ•°æ®åˆ†æå›ç­”ç”¨æˆ·çš„é—®é¢˜.


            # è¡¨ç»“æ„å®šä¹‰:  {{#1735525806917.column_data#}}

            '
        - id: abb84ba3-0155-46be-9b34-c250dcb23474
          role: user
          text: "human: {{#1734683532736.question_str#}}\n\n# çº¦æŸ:\n- è¯·æ³¨æ„ç”ŸæˆSQLæ—¶ä¸è¦å¼„é”™è¡¨å’Œåˆ—çš„å…³ç³»ã€‚\n\
            - è¯·æ£€æŸ¥SQLçš„æ­£ç¡®æ€§ï¼Œå¹¶ä¿è¯æ­£ç¡®çš„æƒ…å†µä¸‹ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚\n- SQLä¸­éœ€è¦ä½¿ç”¨çš„è¡¨åæ˜¯: excel_table,è¯·æ£€æŸ¥ä½ ç”Ÿæˆçš„sqlï¼Œä¸è¦ä½¿ç”¨æ²¡åœ¨æ•°æ®ç»“æ„ä¸­çš„åˆ—åã€‚\n\
            - ä¼˜å…ˆä½¿ç”¨æ•°æ®åˆ†æçš„æ–¹å¼å›ç­”ï¼Œå¦‚æœç”¨æˆ·é—®é¢˜ä¸æ¶‰åŠæ•°æ®åˆ†æå†…å®¹ï¼Œä½ å¯ä»¥æŒ‰ä½ çš„ç†è§£è¿›è¡Œå›ç­”ã€‚\n- ç”¨æˆ·åœ¨é—®é¢˜ä¸­æŒ‡å®šäº†ä»–å¸Œæœ›è·å¾—çš„å…·ä½“æ•°æ®è¡Œæ•°ï¼Œå¦‚æœå¤§äº50åˆ™å§‹ç»ˆå°†æŸ¥è¯¢é™åˆ¶ä¸ºæœ€å¤š50ä¸ªç»“æœ\n\
            - è¯·æ ¹æ®ç”¨æˆ·é—®é¢˜ç†è§£ç”¨æˆ·æ„å›¾ï¼Œä½¿ç”¨ç»™å‡ºè¡¨ç»“æ„å®šä¹‰åˆ›å»ºä¸€ä¸ªè¯­æ³•æ­£ç¡®çš„ duckdb sqlï¼Œå¦‚æœä¸éœ€è¦sqlï¼Œåˆ™ç›´æ¥å›ç­”ç”¨æˆ·é—®é¢˜ã€‚\n- æ‰€æœ‰æŸ¥è¯¢çš„å€¼éƒ½å¿…é¡»æœ‰åˆ«åï¼Œæ¯”å¦‚ä»è¡¨ä¸­é€‰æ‹©\
            \ SELECT äº§åœ°, COUNT(*) as å•†å“æ•°é‡ FROM excel_table GROUP BY äº§åœ°\n- åªèƒ½ä½¿ç”¨è¡¨ç»“æ„ä¿¡æ¯ä¸­æä¾›çš„è¡¨æ¥ç”Ÿæˆ\
            \ sqlï¼Œå¦‚æœæ— æ³•æ ¹æ®æä¾›çš„è¡¨ç»“æ„ä¸­ç”Ÿæˆ sql ï¼Œè¯·è¯´ï¼š'æä¾›çš„è¡¨ç»“æ„ä¿¡æ¯ä¸è¶³ä»¥ç”Ÿæˆ sql æŸ¥è¯¢ã€‚'ç¦æ­¢éšæ„æé€ ä¿¡æ¯ã€‚\n- è¯·ä»å¦‚ä¸‹ç»™å‡ºçš„å±•ç¤ºæ–¹å¼ç§é€‰æ‹©æœ€å½¢è±¡çš„ä¸€ç§ç”¨ä»¥è¿›è¡Œæ•°æ®æ¸²æŸ“ï¼Œå°†ç±»å‹åç§°æ”¾å…¥è¿”å›è¦æ±‚æ ¼å¼çš„nameå‚æ•°å€¼ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æœ€åˆé€‚çš„åˆ™ä½¿ç”¨'Table'ä½œä¸ºå±•ç¤ºæ–¹å¼ï¼Œæ•°æ®å±•ç¤ºæ–¹å¼å¦‚ä¸‹:\n\
            \ {{#1721978276391.nl2sql_display_type#}}\n# è¿”å›æ ¼å¼:\n è¯·ä¸€æ­¥æ­¥æ€è€ƒå¹¶æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼å›å¤ï¼š{{#1721978276391.nl2sql_response#}}\n\
            \ ç¡®ä¿è¿”å›æ­£ç¡®çš„jsonå¹¶ä¸”å¯ä»¥è¢«Python json.loadsæ–¹æ³•è§£æ."
        selected: false
        title: æ–‡ä»¶é—®ç­”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1735526005555'
      position:
        x: 3070
        y: 1115
      positionAbsolute:
        x: 3070
        y: 1115
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-1
            key: ''
            type: text
            value: '{{#1735526005555.text#}}'
          type: json
        desc: æ‰§è¡ŒSQLè¯­å¥å°è£…ç»“æœé›†
        headers: ''
        method: post
        params: file_key:{{#1734683532736.file_key#}}
        retry_config:
          max_retries: 3
          retry_enabled: false
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: è·å–æ•°æ®é›†
        type: http-request
        url: http://host.docker.internal:8088/file/process_file_llm_out
        variables: []
      height: 154
      id: '17355298585890'
      position:
        x: 3374
        y: 1111.5
      positionAbsolute:
        x: 3374
        y: 1111.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(db_result: str):\n    try:\n        db_result_json\
          \ = json.loads(db_result)\n        db_data = json.loads(db_result_json['data'])\n\
          \n        return {\n            \"res_code\": str(db_result_json['code']),\n\
          \            \"res_data\": str(db_data['data'])\n        }\n    except Exception\
          \ as e :\n        return {\"res_code\": \"9999\"}"
        code_language: python3
        desc: ''
        outputs:
          res_code:
            children: null
            type: string
          res_data:
            children: null
            type: string
        selected: false
        title: è§£æè¿”å›ç»“æœ
        type: code
        variables:
        - value_selector:
          - '17355298585890'
          - body
          variable: db_result
      height: 54
      id: '1735530100215'
      position:
        x: 3678
        y: 1088.5
      positionAbsolute:
        x: 3678
        y: 1088.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is not
            id: b544b6b3-d1be-4047-bb52-8117e61b5c91
            value: '200'
            varType: string
            variable_selector:
            - '1735530100215'
            - res_code
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­çŠ¶æ€
        type: if-else
      height: 126
      id: '1735530110523'
      position:
        x: 3982
        y: 1088.5
      positionAbsolute:
        x: 3982
        y: 1088.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1721978276391.data_reveal#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 143
      id: '1735530121003'
      position:
        x: 4286
        y: 1088.5
      positionAbsolute:
        x: 4286
        y: 1088.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#17355423844960.text#}}{{#1721978276391.dify_1_t02#}}

          {{#1721978276391.dify_0_t04#}}{{#17355298585890.body#}}{{#1721978276391.dify_1_t04#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 200
      id: '1735530155560'
      position:
        x: 4590
        y: 1259
      positionAbsolute:
        x: 4590
        y: 1259
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”Ÿæˆæ€»ç»“ä¿¡æ¯
        model:
          completion_params:
            num_ctx: 20480
            num_thread: 4
            temperature: 0.5
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 48d8610a-aab1-4e2e-8fd1-3111b94de508
          role: system
          text: '# ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æä¸“å®¶,ç²¾é€šä»ç»“æ„åŒ–æ•°æ®æ€»ç»“åˆ†æ

            '
        - id: d424dafa-ebed-4271-90e5-4bafff0ca243
          role: user
          text: "# ä»»åŠ¡: è¯·ä»ä»¥ä¸‹ç»“æ„åŒ–æ•°æ®ä¸­,æ€»ç»“åˆ†æå‡ºæ•°æ®è¶‹åŠ¿\n\n----\n# ç»“æ„åŒ–æ•°æ®å†…å®¹:  {{#1735530100215.res_data#}}\n\
            # ç»“æ„åŒ–æ•°æ®æ ¼å¼è¯´æ˜: \n- column å­—æ®µä»£è¡¨æ ¼åˆ—å®šä¹‰\n- resultä»£è¡¨æ•°æ®æ˜ç»†\n\n----\n# çº¦æŸ:\n - è¾“å‡ºç»“æœä¸èƒ½å‡ºç°è‹±æ–‡å’Œç¹ä½“å­—\n\
            \ - ä¸¥æ ¼ä¾æ®æ•°æ®é›†å›ç­”ä¸è¦è™šæ„\n - æ•°æ®é›†ä¸ºç©ºæ—¶è¿”å›ç©º\n - ä¸è¦è¾“å‡ºæ€è€ƒè¿‡ç¨‹\n - è¯ˆéª—æ¡ˆä»¶æ•°é‡ä»resultå­—æ®µä¸­ç»Ÿè®¡\n\
            \ - å­—æ•°é™åˆ¶åœ¨150å­—ä»¥å†…\n - è¯·ä¸€æ­¥ä¸€æ­¥æ€è€ƒå¹¶æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¾“å‡º\n\n# è¾“å‡ºæ ¼å¼:  æ–‡æœ¬"
        selected: false
        title: åˆ†ææ•°æ®
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '17355423844960'
      position:
        x: 4286
        y: 1271.5
      positionAbsolute:
        x: 4286
        y: 1271.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1721978276391.dify_0_t02#}}{{#1740559499175.text#}}{{#1721978276391.dify_1_t02#}}'
        desc: ''
        selected: false
        title: è¿”å›é—®ç­”ç»“æœ
        type: answer
        variables: []
      height: 143
      id: '1740381923341'
      position:
        x: 2158
        y: 1084.5
      positionAbsolute:
        x: 2158
        y: 1084.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 100
        model:
          completion_params:
            temperature: 0.4
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 5e995084-c4fd-44cd-903c-0937bee29500
          role: system
          text: '# ä½ æ˜¯ä¸€ä¸ªå…¨èƒ½çš„ä¸“å®¶è¯·åˆ†æç”¨æˆ·é—®é¢˜è¿›è¡Œå›å¤'
        - id: 8e71e6d6-e2d6-4974-86d9-23afecf2a6b0
          role: user
          text: '# ç”¨æˆ·é—®é¢˜: {{#sys.query#}}

            # ä»»åŠ¡: åˆ†æç”¨æˆ·é—®é¢˜è¿›è¡Œå›å¤'
        selected: false
        title: é€šç”¨é—®ç­”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1740559499175'
      position:
        x: 1854
        y: 1088.5
      positionAbsolute:
        x: 1854
        y: 1088.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -1513
      y: -263.0000000000001
      zoom: 0.7
